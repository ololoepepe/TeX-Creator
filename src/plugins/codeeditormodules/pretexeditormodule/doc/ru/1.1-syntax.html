<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Синтаксис PreTeX</title>
[Назад: <a href="../ru/1-pretex_plugin.html">1. Плагин PreTeX</a>]
[Далее: <a href="../ru/1.2-running_and_recording.html">1.1. Запуск и запись</a>]
<br><br>
<center><font size=5><b>Синтаксис PreTeX</b></font></center>
<br><br>
В отличие от TeX, являющегося языком верстки, PreTeX является, по своей сути, императивным интерпретируемым языком
программирования. Это означает, что исходные тексты PreTeX преобразуются в команды, которые интерпретатор выполняет по
мере выполнения программы.
<br><br>
В языке PreTeX существует четыре вида сущностей:
<ol>
 <li>Литералы (строки, целые числа и действительные числа)</li>
 <li>Имена функций, переменных и массивов</li>
 <li>Конструкция \input{&quot;...&quot;}</li>
 <li>Номера аргументов</li>
 <li>Специальные символы (фигурные и квадратные скобки, обратный слеш)</li>
 <li>Комментарии</li>
</ol>
<font size=4><b>Литералы</b></font>
<br><br>
Литералы - это константы, указываемые в исходном тексте. Их значения известны уже в начале выполнения программы
(в отличие от, например, значения переменных).
<br><br>
<b><i>Строковый литерал</i></b> представляет собой любое сочетание символов, заключенное в двойные кавычки (&quot;).
Исключение составляют символы собственно двойных кавычек. Эти символы необходимо <i>экранировать</i>, то есть
предварять обратным слешем (\). Поддерживаются следующие экранирующие последовательности:
<ul>
 <li><b>\&quot;</b> - преобразуется в символ двойных кавычек</li>
 <li><b>\\</b> - преобразуется в обратный слеш</li>
 <li><b>\n</b> - преобразуется в конец строки</li>
 <li><b>\t</b> - преобразуется в символ табуляции</li>
 <li><b>\s</b> - преобразуется в пробел</li>
</ul>
Пример строки:
<font color="#33842B">&quot;Это -\sстрока, в которой есть символ \&quot;\%\&quot; и число 15&quot;</font>
<br>
Эта строка будет преобразована в следующий текст: <i>Это - строка, в которой есть символ &quot;%&quot; и число 15</i>
<br><br>
<b><i>Целочисленный литерал</i></b> - это целое число. Например, <font color="#000088">125</font>,
<font color="#000088">0</font>, <font color="#000088">-9000</font>.
<br><br>
<b><i>Литерал действительного числа</i></b> - это сущность вида <font color="#000088">3.14</font> или
<font color="#000088">-100.500</font>.
<br><br>
<font size=4><b>Специальные символы</b></font>
<br><br>
Специальные символы используются для отделения аргументов от имени функции и друг от друга.
<ul>
 <li><b>\</b> - ставится перед именами функций и переменных для сохранения внешней схожести с языком TeX</li>
 <li><b>{</b> - отделяет обязательный аргумент функции от ее имени, либо предыдущий обязательный аргумент от
 следующего</li>
 <li><b>}</b> - завершает обязательный аргумент</li>
 <li><b>[</b> - отделяет первый необязательный аргумент функции от последнего обязательного, либо предыдущий
 необязательный аргумент от следующего</li>
 <li><b>]</b> - завершает необязательный рагумент</li>
 <li><b>#</b> - ставится перед номером аргумента</li>
</ul>
<font size=4><b>Имена функций, переменных и массивов</b></font>
<br><br>
Имена функций, переменных и массивов могут начинаться с буквы или символа подчеркивания (_). Далее могут следовать
цифры, буквы и символ подчеркивания. Поддерживаются символы кириллицы и других алфавитов. Кроме того, некоторые
встроенные функции могут состоять из специальных символов, например: +, *, == и так далее. <b>Важно:</b> имена функций
всегда должны следовать только за обратным слешем (\), в противном случае при попытке выполнить программу будет
сообщено об ошибке синтаксиса.
<br><br>
После имени функции, переменной или массива всегда обязательно должна стоять пара фигурных скобок ({, }). Внутри них
может содержаться аргумент функции или индекс массива. В случае с переменной скобки должны быть пустыми. Для функций
необходимо указать столько пар фигурных скобок, сколько эта функция принимает аргументов. После этого можно указать
(но можно и не указывать) необязательные аргументы в квадратных скобках ([, ]). Необязательные аргументы, как и
обязательные, следуют строго по порядку. Если требуется указать следующий аргумент, пропустив предыдущий, то необходимо
указать предыдущий аргумент как пустую пару квадратных скобок ([]). Встроенные функции (а также количество их
аргументов) подробно описаны в следующих разделах. 
При обращении к элементу массива (если это двумерный, трехмерный или более мерный массив) необходимо после первого
индекса указать в квадратных скобках все последующие. Нумерация начинается с нуля. Индекс должен быть неотрицательным
целым числом, и не должен превышать границу, заданную при создании массива.
<br><br>
Встроенные функции и функции, определенные пользователем, а также массивы и переменные подсвечиваются разным цветом.
Примеры вызова встроенных функций:
<br>
<font color="#B48C1E">\newLocalFunc</font>{<font color="#B90000">f</font>}{
<font color="#B48C1E">\insert</font>{<font color="#33842B">&quot;Ура!&quot;</font>}}[<font color="#000088">1</font>],
<font color="#B48C1E">\if</font>{<font color="#B48C1E">\&gt;=</font>{<font color="#000088">2</font>}{
<font color="#000088">1</font>}}{<font color="#B90000">\f</font>{}}.
<br>Пользовательские:
<font color="#B90000">\ f{}</font> (обратите внимание на пробел: допускается его наличие),
<br>
<font color="#B90000">\_функция_Васи_98</font>{<font color="#000088">1</font>}[][<font color="#000088">-10</font>],
<font color="#B90000">\my_var{}</font>.
<br><br>
<font size=4><b>Конструкция \input{&quot;...&quot;}</b></font>
<br><br>
Данная конструкция похожа на вызов функции, однако она выполняется на этапе анализа, до выполнения программы. По сути
эта конструкция просто подставляет содержимое файла, имя которого указано как строковый параметр, вместо самой себя.
Если задано неполное имя файла (без пути к нему), то PreTeX попытается найти этот файл в той же папке, где находится
файл, в котором присутствует данная конструкция.
<br><br>
<font size=4><b>Номера аргументов</b></font>
<br><br>
Номера аргументов - особые конструкции, начинающиеся с символа решетки (#) и служащие в качестве ссылок на аргументы
внутри функций, определяемых пользователем. После символа решетки должен следовать целочисленный литерал (число должно
быть больше либо равно нулю и не должно превышать количество аргументов данной функции; при этом нумерация начинается с
нуля, а номер первого необязательного аргумента равен номеру последнего обязательного плюс 1). Также допускается вместо
целочисленного литерала указать вызов функции. Функция обязана возвращать значение целого типа, отвечающее тем же
условиям, что и литерал. В противном случае будет сообщено об ошибке во время выполнения.
<br><br>
Примеры: <font color="#33842B">#</font><font color="#000088">1</font>,
<font color="#33842B">#</font><font color="#B48C1E">\toInt</font>{<font color="#B90000">\_функция_Васи_98</font>{
<font color="#000088">1</font>}}.
<br><br>
<font size=4><b>Комментарии</b></font>
<br><br>
В PreTeX поддерживаются как привычные для пользующихся TeX однострочные комментарии, начинающиеся с символа процента
(%), так и многострочные, заключенные между парами символов процентов. Текст внутри комментариев игнорируется при
выполнении программы. Примеры:
<br><br>
<font color="#B90000">\f{}</font> <font color="#808080">%Это - однострочный комментарий</font>
<br>
<font color="#B90000">\myfunc{}</font>
<br>
<font color="#808080">%%А это - многострочный
<br>
\_функция_Васи_98{1}[][-10
<br>
\f{}
<br>
%%</font>
<br>
<font color="#B90000">\myfunc{}</font>
<br><br>
<font size=4><b>Пример программы</b></font>
<br><br>
Ниже приведен пример простейшей программы на языке PreTeX, которая запрашивает у пользователя его имя и вставляет в
текущий документ 5 раз:
<br><br>
<font color="#B48C1E">\newVar</font>{<font color="#B90000">name</font>}[<font color="#B48C1E">\getInput</font>{
<font color="#33842B">&quot;text&quot;</font>}[<font color="#33842B">&quot;Введите ваше имя:&quot;</font>]]
<br>
<font color="#B48C1E">\for</font>{<font color="#B90000">i</font>}{<font color="#000088">1</font>}{
<font color="#000088">5</font>}{<font color="#000088">1</font>}
<br>
{
<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#B48C1E">\insert</font>{<font color="#33842B">&quot;Ваше имя: &quot;</font>
<font color="#B90000">\name</font>{}<font color="#33842B">&quot;\n&quot;</font>}
<br>    
}
<br><br>
Обратите внимание на то, что в качестве аргумента функции \insert передано сочетание строкового литерала и вызова
функции. Такие конструкции допустимы, при вычислении аргумента все выражения, из которых он состоит, суммируются.
Причем, если все они - целые числа, то сложение произойдет по правилу сложения для целых чисел; если хотя бы одно
выражение будет действительным числом - все числа будут приведены к типу действительных чисел; если же присутствует
хотя бы одно строка - все выражения будут преобразованы в строки, и лишь потом сложены (<i>конкатенированы</i>).
Выражения, не имеющие значения (например, вызов функции, которая не возвращает ничего), будут пропущены.
<br><br>
[Назад: <a href="../ru/1-pretex_plugin.html">1. Плагин PreTeX</a>]
[Далее: <a href="../ru/1.2-running_and_recording.html">1.1. Запуск и запись</a>]
